<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Galería de Arte Herelba</title>

<meta name="description" content="Galería virtual. Espacio de artistas para artistas.">
<meta name="keywords" content="Arte, Pintura, Fotografía, Escultura, Galería">
<meta name="author" content="Galería Herelba">

<link href="https://fonts.googleapis.com/css?family=MedievalSharp" rel="stylesheet">

<style>
:root{
  --gold:#D4A017;
  --dark:#111;
  --bg:#f7f7f7;
  --radius:10px;
  --shadow:0 2px 8px rgba(0,0,0,.12);
}

body{
  margin:0;
  font-family:'MedievalSharp', system-ui, sans-serif;
  background:var(--bg);
  color:#222;
}

header{
  background:var(--dark);
  color:#fff;
  text-align:center;
  padding:20px;
}

.brand h1{margin:0;font-size:30px;}

.gallery{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
  gap:16px;
  padding:20px;
  max-width:1200px;
  margin:auto;
}

.card{
  background:#fff;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  transition:transform .2s ease;
}

.card:hover{transform:translateY(-3px);}

.image-wrapper{
  position:relative;
}

.image-wrapper img{
  width:100%;
  height:200px;
  object-fit:cover;
  cursor:pointer;
}

.image-wrapper img.sold {
  filter: brightness(0.5) grayscale(0.5);
  cursor: not-allowed;
  pointer-events: none; /* esto también evita clicks, pero solo visualmente */
}

.sold-badge{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.7);
  color:#fff;
  font-size:30px;
  font-weight:bold;
  display:flex;
  align-items:center;
  justify-content:center;
  letter-spacing:4px;
  text-transform:uppercase;
  pointer-events:none;
}

.info{
  padding:12px;
}

.info h3{
  margin:0;
  font-size:18px;
}

.buy{
  display:inline-block;
  margin-top:10px;
  background:var(--gold);
  color:#fff;
  padding:8px 14px;
  border-radius:6px;
  text-decoration:none;
}

.buy:hover{background:#e0ac1c;}

footer{
  text-align:center;
  padding:20px;
  font-size:14px;
  color:#666;
}

/* Modal */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.8);
  display:none;
  align-items:center;
  justify-content:center;
}

.modal.open{display:flex;}

.modal-content{
  background:#fff;
  padding:20px;
  border-radius:var(--radius);
  max-width:800px;
  width:90%;
}

.modal-content img{
  width:100%;
  border-radius:6px;
}

.close{
  float:right;
  cursor:pointer;
  font-size:20px;
}
</style>
</head>

<body>

<header>
  <div class="brand">
    <h1>Galería de Arte</h1>
  </div>
  <p>Explora y adquiere obras destacadas</p>
</header>

<main>
  <section class="gallery" id="gallery"></section>
</main>

<div class="modal" id="modal">
  <div class="modal-content">
    <span class="close" id="close">✕</span>
    <h2 id="modal-title"></h2>
    <p id="modal-artist"></p>
    <img id="modal-img" alt="">
    <p id="modal-desc"></p>
    <p id="modal-price" style="font-weight:bold"></p>
    <a id="modal-buy" class="buy" target="_blank">Comprar</a>
  </div>
</div>

<footer>
  © 2025 Galería de Arte
</footer>

<script>
const gallery = document.getElementById('gallery');
const modal = document.getElementById('modal');

const modalTitle  = document.getElementById('modal-title');
const modalArtist = document.getElementById('modal-artist');
const modalImg    = document.getElementById('modal-img');
const modalDesc   = document.getElementById('modal-desc');
const modalPrice  = document.getElementById('modal-price');
const modalBuy    = document.getElementById('modal-buy');

let artworks = [];

const isSold = price => price.trim().toLowerCase() === 'sold';

async function loadArtworksFromXML(path='artworks.xml'){
  try{
    const res = await fetch(path);
    if(!res.ok) throw new Error(res.status);
    const xml = new DOMParser().parseFromString(await res.text(), 'text/xml');

    artworks = [...xml.getElementsByTagName('artwork')].map(n=>({
      id:+n.querySelector('id')?.textContent,
      title:n.querySelector('title')?.textContent || '',
      artist:n.querySelector('artist')?.textContent || '',
      price:n.querySelector('price')?.textContent || '',
      img:n.querySelector('img')?.textContent || '',
      desc:n.querySelector('desc')?.textContent || '',
      phone:n.querySelector('phone')?.textContent || ''
    }));

    render();
  }catch(e){
    console.error(e);
    gallery.innerHTML = '<p style="color:red;text-align:center">Error al cargar obras</p>';
  }
}

function render(){
  gallery.innerHTML = '';
  artworks.forEach(a=>{
    const sold = isSold(a.price);
    gallery.insertAdjacentHTML('beforeend',`
      <div class="card">
        <div class="image-wrapper">
          <img src="${a.img}" alt="${a.title}" data-id="${a.id}" class="${sold ? 'sold' : ''}">
          ${sold ? '<div class="sold-badge">SOLD</div>' : ''}
        </div>
        <div class="info">
          <h3>${a.title}</h3>
        </div>
      </div>
    `);
  });
}

// Delegación de eventos: escucha todos los clicks en la galería
gallery.addEventListener('click', e => {
  // Solo interesa clics en imágenes
  if (e.target.tagName !== 'IMG') return;

  // Si la imagen tiene clase 'sold', NO abrir modal
  if (e.target.classList.contains('sold')) return;

  // Abrir modal solo si está disponible
  openModal(+e.target.dataset.id);
});

function openModal(id){
  const a = artworks.find(x=>x.id===id);
  if(!a) return;

  modalTitle.textContent = a.title;
  modalArtist.textContent = a.artist;
  modalImg.src = a.img;
  modalDesc.textContent = a.desc;

  if(isSold(a.price)){
    modalPrice.textContent = 'VENDIDO';
    modalBuy.style.display = 'none';  // botón desaparece
    modalImg.classList.add('sold');   // opcional: refuerza el estilo
  } else {
    modalPrice.textContent = 'Precio: ' + a.price;
    modalBuy.style.display = 'inline-block';
    modalImg.classList.remove('sold');
    modalBuy.href = `https://wa.me/${a.phone.replace(/\D/g,'')}?text=Quiero%20comprar%20${encodeURIComponent(a.title)}`;
  }

  modal.classList.add('open');
}


document.getElementById('close').onclick = ()=>modal.classList.remove('open');
modal.onclick = e=>{ if(e.target===modal) modal.classList.remove('open'); };

loadArtworksFromXML();
</script>

</body>
</html>
